import pygame, math, random, sys
pygame.init()

# Kích thước cửa sổ
WIDTH, HEIGHT = 800, 600
screen = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption("💖 Chúc mừng ngày 20/10 💖")

# Màu và font
font = pygame.font.SysFont("Segoe Script", 48, bold=True)
text_color = (255, 100, 200)
heart_color = (255, 0, 100)

# Hiệu ứng sao rơi
stars = [{"x": random.randint(0, WIDTH), "y": random.randint(0, HEIGHT),
          "speed": random.uniform(0.5, 2.5)} for _ in range(120)]

clock = pygame.time.Clock()

# Hàm vẽ trái tim lung linh
def draw_heart(surface, t, pulse):
    for i in range(1000):
        theta = i / 100 * math.pi
        x = 16 * math.sin(theta) ** 3
        y = 13 * math.cos(theta) - 5 * math.cos(2 * theta) - 2 * math.cos(3 * theta) - math.cos(4 * theta)
        x = WIDTH // 2 + int(x * 15 * pulse)
        y = HEIGHT // 2 - int(y * 15 * pulse)
        glow = random.randint(180, 255)
        color = (glow, 0, glow)
        surface.set_at((x, y), color)

# Phát nhạc nền (nếu có file nhạc piano.mp3 cùng thư mục)
try:
    pygame.mixer.music.load("piano.mp3")
    pygame.mixer.music.play(-1)
except:
    pass  # Không bắt buộc có nhạc

# Vòng lặp chính
t = 0
while True:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            pygame.quit()
            sys.exit()

    screen.fill((10, 10, 20))  # nền đen xanh tím

    # Vẽ sao rơi
    for s in stars:
        s["y"] += s["speed"]
        if s["y"] > HEIGHT:
            s["y"] = 0
            s["x"] = random.randint(0, WIDTH)
        pygame.draw.circle(screen, (255, 255, 255), (int(s["x"]), int(s["y"])), 1)

    # Trái tim đập
    pulse = 1 + 0.05 * math.sin(t)
    draw_heart(screen, t, pulse)

    # Dòng chữ lung linh
    glow = int(128 + 127 * abs(math.sin(t / 2)))
    text = font.render("Chúc mừng ngày 20/10", True, (255, glow, 200))
    rect = text.get_rect(center=(WIDTH // 2, HEIGHT - 80))
    screen.blit(text, rect)

    pygame.display.flip()
    t += 0.1
    clock.tick(60)
